<div class="max-w-6xl mx-auto">
  <!-- Banner e cabeçalho -->
  <div class="relative mb-8 rounded-lg overflow-hidden shadow-md">
    <div class="bg-[#222] h-32 md:h-40 flex items-center">
      <div class="absolute inset-0 bg-black opacity-60"></div>
      <div class="relative px-6 py-5 z-10 w-full">
        <h1 class="text-2xl md:text-3xl font-bold text-white"><%= @club.name %></h1>
        <p class="text-white text-sm md:text-base mt-1 opacity-90"><%= @club.description %></p>
      </div>
    </div>
    <div class="absolute top-4 right-4 flex space-x-2">
      <% admin = @club.club_users.find_by(user: current_user)&.is_admin %>
      <% if admin %>
        <%= link_to edit_club_path(@club), class: "bg-[#F9EDEF] hover:bg-white text-[#8B2635] font-medium py-1 px-3 rounded-md inline-flex items-center transition duration-200 text-sm shadow-sm" do %>
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-1">
            <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
          </svg>
          Editar
        <% end %>
      <% end %>
      <%= link_to clubs_path, class: "bg-white hover:bg-gray-100 text-gray-700 font-medium py-1 px-3 rounded-md inline-flex items-center transition duration-200 text-sm shadow-sm" do %>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-1">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3" />
        </svg>
        Voltar
      <% end %>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Coluna da esquerda -->
    <div class="md:col-span-2 space-y-6">
      <!-- Livro atual -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div class="border-b border-gray-100 px-4 py-3 bg-gray-50 flex justify-between items-center">
          <h2 class="text-lg font-semibold text-gray-800">Livro Atual</h2>
          <button class="text-xs bg-[#8B2635] hover:bg-[#731F2D] text-white px-3 py-1 rounded transition duration-200">
            Atualizar Progresso
          </button>
        </div>
        <div class="p-4">
          <div class="flex">
            <div class="flex-shrink-0 w-20 h-28 bg-[#F2E9CE] mr-4 rounded-md flex items-center justify-center text-[#8B2635]">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
              </svg>
            </div>
            <div>
              <h3 class="font-semibold mb-1">Nenhum livro selecionado</h3>
              <p class="text-sm text-gray-600 mb-3">Selecione um livro para iniciar a leitura</p>
              
              <div class="w-full bg-gray-200 rounded-full h-2.5 mb-1">
                <div class="bg-[#8B2635] h-2.5 rounded-full" style="width: 45%"></div>
              </div>
              <div class="flex justify-between items-center text-xs text-gray-500">
                <span>Progresso</span>
                <span>156/224 páginas (45%)</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Discussões recentes -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div class="border-b border-gray-100 px-4 py-3 bg-gray-50 flex justify-between items-center">
          <h2 class="text-lg font-semibold text-gray-800">Discussões Recentes</h2>
          <button class="text-xs bg-[#8B2635] hover:bg-[#731F2D] text-white px-3 py-1 rounded transition duration-200">
            Iniciar Discussão
          </button>
        </div>
        <div class="divide-y divide-gray-100">
          <div class="p-4">
            <h3 class="font-semibold mb-1">O Simbolismo do Livro</h3>
            <p class="text-sm text-gray-600 mb-2">Quais são os principais símbolos encontrados na obra?</p>
            <div class="flex items-center text-xs text-gray-500">
              <div class="w-6 h-6 rounded-full bg-[#F9EDEF] flex items-center justify-center text-[#8B2635] mr-2">J</div>
              <span>João Silva - 14 de abril, 15:30</span>
            </div>
            <div class="mt-2 text-sm">
              <a href="#" class="text-[#8B2635] hover:underline">5 comentários</a>
            </div>
          </div>
          
          <div class="p-4">
            <h3 class="font-semibold mb-1">Personagens Principais</h3>
            <p class="text-sm text-gray-600 mb-2">Vamos discutir o desenvolvimento dos personagens principais.</p>
            <div class="flex items-center text-xs text-gray-500">
              <div class="w-6 h-6 rounded-full bg-[#F9EDEF] flex items-center justify-center text-[#8B2635] mr-2">M</div>
              <span>Maria Costa - 10 de abril, 09:15</span>
            </div>
            <div class="mt-2 text-sm">
              <a href="#" class="text-[#8B2635] hover:underline">8 comentários</a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Próximos eventos -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div class="border-b border-gray-100 px-4 py-3 bg-gray-50 flex justify-between items-center">
          <h2 class="text-lg font-semibold text-gray-800">Próximos Eventos</h2>
          <button class="text-xs bg-[#8B2635] hover:bg-[#731F2D] text-white px-3 py-1 rounded transition duration-200">
            Agendar Evento
          </button>
        </div>
        <div class="p-4">
          <div class="flex">
            <div class="flex-shrink-0 w-14 h-14 bg-[#F9EDEF] rounded-md mr-4 flex flex-col items-center justify-center text-[#8B2635]">
              <span class="text-xs font-medium">JUN</span>
              <span class="text-lg font-bold">15</span>
            </div>
            <div>
              <h3 class="font-semibold">Discussão do Livro</h3>
              <p class="text-sm text-gray-600 mb-1">Biblioteca Municipal, Sala 3</p>
              <p class="text-xs text-gray-500">19:00 - 20:30</p>
              <div class="flex items-center mt-2">
                <span class="text-xs text-gray-500 mr-3">7 participantes</span>
                <button class="text-xs bg-[#8B2635] hover:bg-[#731F2D] text-white px-2 py-0.5 rounded transition duration-200">
                  Confirmar Presença
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Chat do clube -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div class="border-b border-gray-100 px-4 py-3 bg-gray-50">
          <h2 class="text-lg font-semibold text-gray-800">Chat do Clube</h2>
        </div>
        <div id="chat" data-controller="chat" data-chat-club-id="<%= @club.id %>">
          <div id="messages" class="hidden">
            <% @club.chat_messages.each do |msg| %>
              <p><%= msg["timestamp"].to_time.strftime("%H:%M") %> <strong><%= msg["user"] %>:</strong> <%= msg["message"] %></p>
            <% end %>
          </div>
          
          <div id="club-chat" class="p-3 h-64 overflow-y-auto">
            <% if @messages.empty? %>
              <div class="text-center text-gray-500 py-10">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10 mx-auto mb-2 text-gray-400">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z" />
                </svg>
                <p class="text-sm">Nenhuma mensagem ainda. Inicie uma conversa!</p>
              </div>
            <% else %>
              <% @messages.each do |message| %>
                <div class="mb-3 <%= message[:user] == current_user.email ? 'text-right' : '' %>">
                  <div class="<%= message[:user] == current_user.email ? 'bg-[#F9EDEF] ml-12' : 'bg-gray-100 mr-12' %> inline-block rounded-lg px-3 py-2 text-sm">
                    <div class="font-medium text-xs mb-1 <%= message[:user] == current_user.email ? 'text-[#8B2635]' : 'text-gray-700' %>">
                      <%= message[:user] == current_user.email ? 'Você' : message[:user] %>
                    </div>
                    <div class="text-gray-800"><%= message[:message] %></div>
                    <div class="text-xs text-gray-500 mt-1"><%= message[:timestamp].strftime("%H:%M") %></div>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
          
          <div class="border-t border-gray-100 p-3">
            <form id="message-form" class="flex">
              <input type="text" id="message-input" placeholder="Digite sua mensagem..." class="flex-grow px-3 py-1 text-sm border rounded-l-md focus:outline-none focus:ring-1 focus:ring-[#8B2635]">
              <button type="submit" class="bg-[#8B2635] hover:bg-[#731F2D] text-white px-4 py-1 text-sm rounded-r-md transition duration-200">Enviar</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Coluna da direita -->
    <div class="space-y-6">
      <!-- Informações da comunidade -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div class="border-b border-gray-100 px-4 py-3 bg-gray-50">
          <h2 class="text-lg font-semibold text-gray-800">Informações do Clube</h2>
        </div>
        <div class="p-4">
          <div class="flex items-center mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-[#8B2635] mr-2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
            </svg>
            <span class="text-gray-700"><%= @club.club_users.count %> membros</span>
          </div>
          
          <h3 class="text-sm font-semibold mb-2 text-gray-700">Membros Ativos</h3>
          <div class="flex flex-wrap gap-1 mb-4">
            <% @club.club_users.includes(:user).limit(5).each do |club_user| %>
              <div class="w-8 h-8 rounded-full bg-[#F9EDEF] flex items-center justify-center text-[#8B2635] text-xs font-medium" title="<%= club_user.user.email %>">
                <%= club_user.user.email[0].upcase %>
              </div>
            <% end %>
            <% if @club.club_users.count > 5 %>
              <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-gray-700 text-xs">
                +<%= @club.club_users.count - 5 %>
              </div>
            <% end %>
          </div>
          
          <button class="w-full text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded transition duration-200">
            Ver Todos os Membros
          </button>
        </div>
      </div>
      
      <!-- Cronograma de leitura -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div class="border-b border-gray-100 px-4 py-3 bg-gray-50">
          <h2 class="text-lg font-semibold text-gray-800">Cronograma de Leitura</h2>
        </div>
        <div class="divide-y divide-gray-100">
          <div class="p-4">
            <h3 class="font-semibold text-sm mb-1">Esta Semana</h3>
            <p class="text-sm text-gray-600">Capítulos 10-15 (Páginas 156-203)</p>
          </div>
          <div class="p-4">
            <h3 class="font-semibold text-sm mb-1">Próxima Semana</h3>
            <p class="text-sm text-gray-600">Capítulos 16-18 (Páginas 204-245)</p>
          </div>
          <div class="p-4">
            <h3 class="font-semibold text-sm mb-1">Data da Discussão</h3>
            <p class="text-sm text-gray-600">Sábado, 15 de junho às 19:00</p>
          </div>
        </div>
      </div>
      
      <!-- Próximo livro -->
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div class="border-b border-gray-100 px-4 py-3 bg-gray-50">
          <h2 class="text-lg font-semibold text-gray-800">Próximo Livro</h2>
        </div>
        <div class="p-4">
          <div class="flex items-center">
            <div class="flex-shrink-0 w-12 h-16 bg-[#F2E9CE] mr-3 rounded-md flex items-center justify-center text-[#8B2635]">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
              </svg>
            </div>
            <div>
              <h3 class="font-semibold text-sm">Orgulho e Preconceito</h3>
              <p class="text-xs text-gray-600">Jane Austen</p>
            </div>
          </div>
          <div class="mt-2 text-center">
            <button class="text-xs bg-[#8B2635] hover:bg-[#731F2D] text-white px-3 py-1 rounded transition duration-200">
              Votar para o Próximo Livro
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const messageForm = document.getElementById('message-form');
    const messageInput = document.getElementById('message-input');
    const chatContainer = document.getElementById('club-chat');
    
    // Rolar para a parte inferior do chat quando a página carrega
    chatContainer.scrollTop = chatContainer.scrollHeight;
    
    // Lidar com o envio de mensagens
    messageForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const message = messageInput.value.trim();
      if (message) {
        // Criar elemento de mensagem
        const messageElement = document.createElement('div');
        messageElement.className = 'mb-3 text-right';
        messageElement.innerHTML = `
          <div class="bg-[#F9EDEF] ml-12 inline-block rounded-lg px-3 py-2 text-sm">
            <div class="font-medium text-xs mb-1 text-[#8B2635]">Você</div>
            <div class="text-gray-800">${message}</div>
            <div class="text-xs text-gray-500 mt-1">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
          </div>
        `;
        
        // Adicionar ao chat e limpar o input
        chatContainer.appendChild(messageElement);
        messageInput.value = '';
        
        // Rolar para a parte inferior
        chatContainer.scrollTop = chatContainer.scrollHeight;
      }
    });
  });
</script>